<link rel="import" href="../polymer/polymer-element.html">

<dom-module id="three-camera">
  <script>
    class ThreeCamera extends Polymer.Element {

      static get is() {
        return 'three-camera'
      }

      static get properties() {
        return {
          modelGeometry: {type: Object, value: {radius: 1, position: [0, 0, 0]}},
          position: Array,
          distanceToTarget: Number,
          frustum: Array,
          object: {
            type: Object,
            computed: '_computeCamera(modelGeometry)',
            notify: true,
          },
        }
      }

      _computeCamera(modelGeometry) {
//        console.log('_computeCamera');
        const modelPosition = modelGeometry.position;
        const modelRadius = modelGeometry.radius;
        this.position = [modelPosition[0], -2.5 * modelRadius, modelPosition[2]];

        const v1 = new THREE.Vector3(...this.position);
        const v2 = new THREE.Vector3(...modelPosition);
        this.distanceToTarget = v1.distanceTo(v2);

        this.frustum = [
          modelRadius * -2,
          modelRadius * 2,
          modelRadius * 2,
          modelRadius * -2,
          this.distanceToTarget - 2 * modelRadius,
          this.distanceToTarget + 2 * modelRadius
        ];

        const camera = new THREE.OrthographicCamera(...this.frustum);
        camera.up = new THREE.Vector3(0, 0, 1);
        camera.position.set(...this.position);
        return camera;
      }
    }

    customElements.define(ThreeCamera.is, ThreeCamera);
  </script>
</dom-module>